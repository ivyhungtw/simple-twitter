(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-72680f18"],{"0b4b":function(t,e,a){"use strict";a("7550")},"149d":function(t,e,a){},"2a29":function(t,e,a){"use strict";a("149d")},"54f8":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"replyDetailContent"},[n("UserSidebar"),n("div",{staticClass:"mainSection"},[n("div",{staticClass:"title"},[n("button",{staticClass:"btn",on:{click:function(e){return t.$router.back()}}},[n("img",{attrs:{src:a("8586"),alt:""}})]),n("h1",[t._v("推文")])]),n("ReplyDetailContent",{attrs:{dataForContent:t.dataForContent},on:{afterToggleLike:t.afterToggleLike}}),n("ReplyDetailList",{attrs:{dataForList:t.dataForList}})],1),n("RecommendedFollowers",{staticClass:"recommendedFollowers"})],1)},r=[],s=a("5530"),i=a("1da1"),o=(a("96cf"),a("a004")),c=a("8f83"),l=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"container"},[n("div",{staticClass:"userInfo"},[n("div",{staticClass:"avatar"},[n("router-link",{attrs:{to:"/userprofile/"+t.localData.user.id}},[t.localData.user?n("img",{attrs:{src:t.localData.user.avatar,alt:""}}):n("img",{attrs:{src:"'' | emptyImageFilter",alt:""}})])],1),n("div",{staticClass:"userTitle"},[n("router-link",{attrs:{to:"/userprofile/"+t.localData.user.id}},[n("p",{staticClass:"text-dark"},[t._v(" "+t._s(t.localData.user?t.localData.user.name:"資料讀取中")+" ")])]),n("p",[t._v("@"+t._s(t.localData.user?t.localData.user.account:"資料讀取中"))])],1)]),n("div",{staticClass:"textContent"},[n("p",[t._v(t._s(t.localData.description))])]),n("div",{staticClass:"updatedAt"},[n("p",{staticClass:"tweetUpdateAt"},[t._v(t._s(t._f("exactDate")(t.localData.updatedAt)))])]),n("div",{staticClass:"feedbackCount"},[n("p",[t._v(t._s(t.localData.commentsLength)+" "),n("span",[t._v("回復 ")])]),n("p",[t._v(t._s(t.localData.likesLength)+" "),n("span",[t._v("喜歡次數")])])]),n("div",{staticClass:"tweetPanel"},[n("div",{staticClass:"comments"},[n("img",{attrs:{"data-toggle":"modal","data-target":"#tweetReplyModal-"+t.localData.id,src:a("f24d"),alt:""}})]),n("TweetReplyModal",t._g({attrs:{tweet:t.dataForModal}},t.$listeners)),n("div",{staticClass:"likes"},[t.localData.isLiked?n("img",{attrs:{src:a("0264"),alt:""},on:{click:function(e){return t.toggleLike()}}}):n("img",{class:{liked:t.localData.isLiked},attrs:{src:a("f91e"),alt:""},on:{click:function(e){return t.toggleLike()}}}),n("p")])],1)])},u=[],d=(a("a4d3"),a("e01a"),a("2708")),p=a("141a"),f=a("2fa3"),m=a("6783"),v={name:"ReplyDetailContent",mixins:[d["a"],d["b"]],components:{TweetReplyModal:p["a"]},props:{dataForContent:{type:Object,required:!0}},data:function(){return{dataForModal:{},localData:{user:{id:null}}}},methods:{setDataForModal:function(){var t=this.dataForContent,e=t.id,a=t.user,n=t.updatedAt,r=t.description,s=t.createdAt;this.dataForModal={id:e,updatedAt:n,description:r,createdAt:s,user:a}},toggleLike:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){var a,n,r,s,i,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(e.prev=0,a=t.dataForContent.id,n=t.dataForContent,!n.isLiked){e.next=14;break}return e.next=6,m["a"].unlikeTweet(a);case 6:if(r=e.sent,s=r.data,"success"===s.status){e.next=10;break}throw new Error(s.message);case 10:n.isLiked=!1,n.likesLength-=1,e.next=22;break;case 14:return e.next=16,m["a"].likeTweet(a);case 16:if(i=e.sent,o=i.data,"success"===o.status){e.next=20;break}throw new Error(o.message);case 20:n.isLiked=!0,n.likesLength+=1;case 22:f["a"].fire({icon:"success",title:"動作執行成功！"}),t.$emit("afterToggleLike",n.isLiked),e.next=29;break;case 26:e.prev=26,e.t0=e["catch"](0),f["a"].fire({icon:"error",title:"無法執行動作，請稍後再試！"});case 29:case"end":return e.stop()}}),e,null,[[0,26]])})))()}},watch:{dataForContent:{handler:function(t){this.localData=t,this.setDataForModal()},deep:!0}}},h=v,g=(a("a189"),a("2877")),C=Object(g["a"])(h,l,u,!1,null,"0bd5d90c",null),w=C.exports,b=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container"},[a("ul",{staticClass:"tweetList"},[t.isLoading?[a("p",{staticClass:"loading"},[t._v("資料讀取中...")])]:[t.localComments.length?t._e():a("p",{staticClass:"noComment"},[t._v(" 成為第一個留言的人! ")]),t._l(t.localComments,(function(e){return a("li",{key:e.id,staticClass:"commentItem"},[a("div",{staticClass:"commentInfo"},[a("div",{staticClass:"avatar"},[a("router-link",{attrs:{to:"/userprofile/"+e.UserId}},[a("img",{attrs:{src:t._f("emptyImageFilter")(e.avatar),alt:""}})])],1),a("div",{staticClass:"commentContent"},[a("div",{staticClass:"userTitle"},[a("router-link",{attrs:{to:"/userprofile/"+e.UserId}},[a("p",[t._v(t._s(e.name))])]),a("p",[t._v("@"+t._s(e.account))]),a("span",{staticClass:"mx-1"},[t._v("·")]),a("p",[t._v(t._s(t._f("fromNow")(e.createdAt)))])],1),a("div",{staticClass:"replyTarget"},[a("p",[t._v(" 回覆 "),a("span",[t._v("@"+t._s(t.dataForList.user.account))])])]),a("div",{staticClass:"textContent"},[a("p",[t._v(t._s(e.comment))])])])])])}))]],2)])},k=[],_=(a("d3b7"),a("3ca3"),a("ddb0"),a("d81d"),a("b0c0"),a("4cce")),R=a("2f62"),L={name:"ReplyDetailList",props:{dataForList:{type:Object,required:!0}},created:function(){var t=this;this.$bus.$on("afterCreateReply",(function(e){t.afterCreateReply(e)}))},data:function(){return{localComments:[],isLoading:!0}},mixins:[d["a"],d["c"]],methods:{fetchAllReplies:function(t){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){var n,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,console.log("fetchAllReplies"),a.next=4,m["a"].getTweetReplies(t);case 4:n=a.sent,r=n.data,e.localComments=r,console.log(e.localComments),a.next=16;break;case 10:a.prev=10,a.t0=a["catch"](0),console.log("fetchAllReplies"),e.isLoading=!1,console.log(a.t0),f["a"].fire({icon:"error",title:"無法取得回覆資料，請稍後再試！"});case 16:case"end":return a.stop()}}),a,null,[[0,10]])})))()},fetchAllReplyUsers:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(t.localComments.map(function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(a){var n,r,i,o,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,_["a"].getUser(a.UserId);case 3:return n=e.sent,r=n.data,i=r.avatar,o=r.name,c=r.account,e.abrupt("return",Object(s["a"])(Object(s["a"])({},a),{},{avatar:i,name:o,account:c}));case 9:e.prev=9,e.t0=e["catch"](0),console.log("fetchAllReplyUsers"),console.log(e.t0),t.isLoading=!1,f["a"].fire({icon:"error",title:"無法取得完整回覆資料，請稍後再試！"});case 15:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}()));case 2:t.localComments=e.sent;case 3:case"end":return e.stop()}}),e)})))()},afterCreateReply:function(t){this.localComments.push(t)}},watch:{dataForList:{handler:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(e){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=e.tweetId,this.isLoading=!0,t.next=4,this.fetchAllReplies(a);case 4:return t.next=6,this.fetchAllReplyUsers();case 6:this.isLoading=!1;case 7:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),deep:!0}},computed:Object(s["a"])({},Object(R["b"])(["currentUser"]))},x=L,y=(a("2a29"),Object(g["a"])(x,b,k,!1,null,"335204e8",null)),D=y.exports,F={name:"ReplyDetail",components:{UserSidebar:o["a"],RecommendedFollowers:c["a"],ReplyDetailContent:w,ReplyDetailList:D},created:function(){var t=this,e=this.$route.params.id;this.fetchTweetInfo(e),this.$bus.$on("afterCreateReply",(function(){t.afterCreateReply()}))},data:function(){return{tweetInfo:{},dataForContent:{},dataForList:{}}},methods:{fetchTweetInfo:function(t){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){var n,r,i,o;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,m["a"].getTweet(t);case 3:n=a.sent,r=n.data,i=r.id,o=r.user,e.tweetInfo=Object(s["a"])({},r),e.dataForContent=Object(s["a"])({},r),e.dataForList={tweetId:i,user:o},a.next=15;break;case 11:a.prev=11,a.t0=a["catch"](0),console.log(a.t0),f["a"].fire({icon:"error",title:"無法取得推文資訊，請稍後再試！"});case 15:case"end":return a.stop()}}),a,null,[[0,11]])})))()},afterToggleLike:function(t){var e=t;this.tweetInfo=Object(s["a"])(Object(s["a"])({},this.tweetInfo),{},{isLiked:e})},afterCreateReply:function(){var t=this.tweetInfo.commentsLength+1;this.tweetInfo=Object(s["a"])(Object(s["a"])({},this.tweetInfo),{},{commentsLength:t})}},watch:{tweetInfo:{deep:!0,handler:function(t){this.dataForContent=t}}}},j=F,O=(a("0b4b"),Object(g["a"])(j,n,r,!1,null,"77c691ed",null));e["default"]=O.exports},7550:function(t,e,a){},8586:function(t,e,a){t.exports=a.p+"img/lastPage.7110cc7e.svg"},a189:function(t,e,a){"use strict";a("a8de")},a8de:function(t,e,a){}}]);
//# sourceMappingURL=chunk-72680f18.274bd00a.js.map