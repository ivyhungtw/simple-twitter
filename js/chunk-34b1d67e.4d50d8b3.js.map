{"version":3,"sources":["webpack:///./src/assets/conversation.svg","webpack:///./src/apis/socket.js","webpack:///./src/components/MessageBox.vue?d575","webpack:///src/components/MessageBox.vue","webpack:///./src/components/MessageBox.vue?3945","webpack:///./src/components/MessageBox.vue?d2a7","webpack:///./src/assets/send.svg","webpack:///./src/views/PublicMessage.vue?367e","webpack:///./src/components/MessageBox.vue?d9bd","webpack:///./src/views/PublicMessage.vue?dddb","webpack:///src/views/PublicMessage.vue","webpack:///./src/views/PublicMessage.vue?e13a","webpack:///./src/views/PublicMessage.vue?56b0"],"names":["module","exports","getPublicRoom","apiHelper","get","createPrivateRoom","userId","post","getPrivateRoom","getNotification","getRoom","roomId","getRoomsByUser","getAvailableUsers","getUnread","render","_vm","this","_h","$createElement","_c","_self","staticClass","on","updateScroll","_v","currentChat","_s","name","account","ref","messageList","length","_l","item","type","key","id","text","class","currentUser","UserId","attrs","_f","avatar","message","createdAt","directives","rawName","value","expression","undefined","domProps","$event","indexOf","_k","keyCode","sendMessage","target","composing","staticRenderFns","mixins","components","props","Object","default","Array","required","atPublic","Boolean","data","isProcessing","updated","console","log","methods","$socket","emit","icon","title","toggleIsProcessing","$refs","scrollTop","scrollHeight","computed","component","onlineUsersCount","_e","user","onlineUsers","sockets","push","Date","joinPublicRoom","username"],"mappings":"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","file":"js/chunk-34b1d67e.4d50d8b3.js","sourcesContent":["module.exports = __webpack_public_path__ + \"img/conversation.873c4926.svg\";","import { apiHelper } from './../utils/helpers'\r\n\r\nexport default {\r\n  getPublicRoom() {\r\n    // getPublicRoom\r\n    return apiHelper.get('/rooms/4')\r\n  },\r\n  createPrivateRoom(userId) {\r\n    return apiHelper.post('/rooms', { userId })\r\n  },\r\n  // 未完成\r\n  getPrivateRoom(userId) {\r\n    return apiHelper.get(`/rooms/${userId}`)\r\n  },\r\n  getNotification() {\r\n    return apiHelper.get('/rooms/notifications')\r\n  },\r\n  getRoom(roomId) {\r\n    return apiHelper.get(`/rooms/${roomId}`)\r\n  },\r\n  getRoomsByUser() {\r\n    // get all chats by rooms\r\n    return apiHelper.get('/rooms')\r\n  },\r\n  getAvailableUsers() {\r\n    return apiHelper.get('rooms/availableUsers')\r\n  },\r\n  getUnread() {\r\n    return apiHelper.get('/private/unread')\r\n  }\r\n}","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"messageBox\"},[(_vm.atPublic)?[_c('div',{staticClass:\"title\",on:{\"click\":_vm.updateScroll}},[_c('h1',[_vm._v(\"公開聊天室\")])])]:[(_vm.currentChat.name)?_c('div',{staticClass:\"title private\"},[_c('h1',[_vm._v(_vm._s(_vm.currentChat.name ? _vm.currentChat.name : \"UserName\"))]),_c('p',[_vm._v(\"@\"+_vm._s(_vm.currentChat.account ? _vm.currentChat.account : \"UserAccount\"))])]):_c('div',{staticClass:\"title noChat\"},[_c('h1',[_vm._v(\"開啟聊天！\")])])],_c('div',{ref:\"messageList\",staticClass:\"container\"},[_c('ul',{staticClass:\"messageList\"},[(_vm.isProcessing)?_c('Spinner'):[(!_vm.messageList.length)?_c('div',{staticClass:\"emptyList\"},[_c('img',{attrs:{\"src\":require(\"../assets/conversation.svg\"),\"alt\":\"\"}})]):_vm._l((_vm.messageList),function(item){return [(item.type === 0)?_c('li',{key:item.id,staticClass:\"actionItem\"},[_c('p',[_vm._v(_vm._s(item.text))])]):_c('li',{key:item.id,staticClass:\"messageItem\",class:{ currentUser: item.UserId === _vm.currentUser.id }},[_c('div',{staticClass:\"mainContent\"},[_c('div',{staticClass:\"avatar\"},[_c('img',{attrs:{\"src\":_vm._f(\"emptyImageFilter\")(item.avatar),\"alt\":\"\"}})]),_c('div',{staticClass:\"textContainer\"},[_c('div',{staticClass:\"text\"},[_vm._v(\" \"+_vm._s(item.message)+\" \")])])]),_c('div',{staticClass:\"textTime\"},[_vm._v(_vm._s(_vm._f(\"fromNow\")(item.createdAt)))])])]})]],2)]),_c('div',{staticClass:\"meesagePanel\"},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.message),expression:\"message\"}],attrs:{\"id\":\"textInput\",\"placeholder\":\"輸入訊息...\",\"type\":\"text\",\"maxlength\":\"160\",\"required\":\"\",\"disabled\":_vm.currentChat.userId === undefined},domProps:{\"value\":(_vm.message)},on:{\"keyup\":function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,\"enter\",13,$event.key,\"Enter\")){ return null; }return _vm.sendMessage($event)},\"input\":function($event){if($event.target.composing){ return; }_vm.message=$event.target.value}}}),_c('button',{staticClass:\"btn sendBtn\",attrs:{\"disabled\":_vm.currentChat.userId === undefined,\"type\":\"submit\"},on:{\"click\":_vm.sendMessage}},[_c('img',{attrs:{\"src\":require(\"../assets/send.svg\"),\"alt\":\"\"}})])])],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"messageBox\">\r\n    <template v-if=\"atPublic\">\r\n      <div class=\"title\" @click=\"updateScroll\">\r\n        <h1>公開聊天室</h1>\r\n      </div>\r\n    </template>\r\n    <template v-else>\r\n      <div class=\"title private\" v-if=\"currentChat.name\">\r\n        <h1>{{ currentChat.name ? currentChat.name : \"UserName\" }}</h1>\r\n        <p>@{{ currentChat.account ? currentChat.account : \"UserAccount\" }}</p>\r\n      </div>\r\n      <div v-else class=\"title noChat\">\r\n        <h1>開啟聊天！</h1>\r\n      </div>\r\n    </template>\r\n\r\n    <div class=\"container\" ref=\"messageList\">\r\n      <ul class=\"messageList\">\r\n        <Spinner v-if=\"isProcessing\"></Spinner>\r\n        <template v-else>\r\n          <div v-if=\"!messageList.length\" class=\"emptyList\">\r\n            <img src=\"../assets/conversation.svg\" alt=\"\" />\r\n          </div>\r\n          <!--  -->\r\n          <template v-else v-for=\"item of messageList\">\r\n            <!-- actionItem -->\r\n            <li v-if=\"item.type === 0\" class=\"actionItem\" :key=\"item.id\">\r\n              <p>{{ item.text }}</p>\r\n            </li>\r\n\r\n            <!-- messageItem: others -->\r\n            <li\r\n              v-else\r\n              class=\"messageItem\"\r\n              :key=\"item.id\"\r\n              :class=\"{ currentUser: item.UserId === currentUser.id }\"\r\n            >\r\n              <div class=\"mainContent\">\r\n                <div class=\"avatar\">\r\n                  <img :src=\"item.avatar | emptyImageFilter\" alt=\"\" />\r\n                </div>\r\n                <div class=\"textContainer\">\r\n                  <div class=\"text\">\r\n                    {{ item.message }}\r\n                  </div>\r\n                </div>\r\n              </div>\r\n              <div class=\"textTime\">{{ item.createdAt | fromNow }}</div>\r\n            </li>\r\n          </template></template\r\n        >\r\n      </ul>\r\n    </div>\r\n    <div class=\"meesagePanel\">\r\n      <input\r\n        @keyup.enter=\"sendMessage\"\r\n        id=\"textInput\"\r\n        placeholder=\"輸入訊息...\"\r\n        type=\"text\"\r\n        v-model=\"message\"\r\n        maxlength=\"160\"\r\n        required\r\n        :disabled=\"currentChat.userId === undefined\"\r\n      />\r\n      <button\r\n        :disabled=\"currentChat.userId === undefined\"\r\n        type=\"submit\"\r\n        class=\"btn sendBtn\"\r\n        @click=\"sendMessage\"\r\n      >\r\n        <img src=\"../assets/send.svg\" alt=\"\" />\r\n      </button>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport Spinner from \"./Spinner\";\r\nimport { fromNowFilter } from \"../utils/mixins\";\r\nimport { emptyImageFilter } from \"../utils/mixins\";\r\nimport { Toast } from \"../utils/helpers\";\r\nimport { mapState } from \"vuex\";\r\n// import $ from \"jquery\";\r\n\r\nexport default {\r\n  name: \"MessageBox\",\r\n  mixins: [emptyImageFilter, fromNowFilter],\r\n  components: { Spinner },\r\n  props: {\r\n    currentChat: {\r\n      type: Object,\r\n      default: function () {\r\n        return {\r\n          userId: undefined,\r\n          name: \"\",\r\n          account: \"\",\r\n        };\r\n      },\r\n    },\r\n    messageList: {\r\n      type: Array,\r\n      required: true,\r\n    },\r\n    atPublic: {\r\n      type: Boolean,\r\n      default: false,\r\n    },\r\n  },\r\n  data() {\r\n    return {\r\n      message: \"\",\r\n      isProcessing: false,\r\n    };\r\n  },\r\n  updated() {\r\n    console.log(\"updated\");\r\n    this.updateScroll();\r\n  },\r\n  methods: {\r\n    sendMessage: function () {\r\n      const message = this.message;\r\n      if (!this.message) {\r\n        Toast.fire({\r\n          icon: \"error\",\r\n          title: \"尚未輸入訊息!\",\r\n        });\r\n        return;\r\n      }\r\n\r\n      const newMessage = !this.messageList.length;\r\n      console.log(\"atPublic: \" + this.atPublic);\r\n\r\n      if (this.atPublic) {\r\n        this.$socket.emit(\r\n          \"chat message\",\r\n          {\r\n            roomId: this.currentRoomId,\r\n            userId: this.currentUser.id,\r\n            newMessage,\r\n            message,\r\n          },\r\n          () => {\r\n            console.log(\"currentRoomId: \" + this.currentRoomId);\r\n            console.log(`private chat message, new: ${newMessage}`);\r\n          }\r\n        );\r\n      } else {\r\n        this.$socket.emit(\r\n          \"private chat message\",\r\n          {\r\n            roomId: this.currentRoomId,\r\n            userId: this.currentUser.id,\r\n            newMessage,\r\n            message,\r\n          },\r\n          () => {\r\n            console.log(\"currentRoomId: \" + this.currentRoomId);\r\n            console.log(`private chat message, new: ${newMessage}`);\r\n          }\r\n        );\r\n      }\r\n\r\n      this.message = \"\";\r\n\r\n      Toast.fire({\r\n        icon: \"success\",\r\n        title: \"訊息已發送!\",\r\n      });\r\n    },\r\n    toggleIsProcessing() {\r\n      this.isProcessing = !this.isProcessing;\r\n    },\r\n    updateScroll() {\r\n      this.$refs.messageList.scrollTop = this.$refs.messageList.scrollHeight;\r\n    },\r\n  },\r\n  computed: {\r\n    ...mapState([\"currentUser\", \"currentRoomId\"]),\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.messageBox {\r\n  flex: 2;\r\n}\r\n.messageBox .title {\r\n  border-bottom: 1px solid #e6ecf0;\r\n  height: 55px;\r\n  padding: 10px 15px;\r\n  display: flex;\r\n  align-items: center;\r\n  position: sticky;\r\n  top: 0;\r\n  background-color: #fff;\r\n  z-index: 1;\r\n}\r\n\r\n.messageBox .private {\r\n  display: block;\r\n  padding: 0;\r\n  padding-left: 10px;\r\n}\r\n\r\n.private h1 {\r\n  height: 50%;\r\n  line-height: 35px;\r\n}\r\n.private p {\r\n  margin: 0;\r\n  padding: 0;\r\n  height: 50%;\r\n}\r\n.title h1 {\r\n  font-weight: 700;\r\n  font-size: 19px;\r\n  margin: 0;\r\n}\r\n\r\n.noChat {\r\n  height: 55px;\r\n  display: flex;\r\n  align-items: center;\r\n}\r\n\r\n.noChat h1 {\r\n  /* margin-top: 20px; */\r\n  display: inline-block;\r\n}\r\n\r\n/* message box */\r\n\r\n.messageBox .container {\r\n  padding: 0;\r\n  display: flex;\r\n  flex-direction: column;\r\n  height: calc(100vh - 115px);\r\n  overflow-y: scroll;\r\n}\r\n\r\n.avatar {\r\n  width: 50px;\r\n  height: 50px;\r\n  border: 1px solid #fff;\r\n  border-radius: 50%;\r\n}\r\n.avatar img {\r\n  width: 100%;\r\n  height: 100%;\r\n  border-radius: 50%;\r\n}\r\n\r\n.messageBox .container::-webkit-scrollbar {\r\n  display: none;\r\n}\r\n\r\n/* for Chrome, Safari and Opera */\r\n.messageBox .container {\r\n  -ms-overflow-style: none;\r\n}\r\n\r\n.messageList {\r\n  flex: 1;\r\n  margin: 0;\r\n  /* min-height: 100%; */\r\n}\r\n\r\n.messageList .emptyList {\r\n  height: 100%;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n}\r\n.messageList .emptyList img {\r\n  min-width: 5%;\r\n  width: 50px;\r\n  height: 50px;\r\n}\r\n\r\n.mainContent {\r\n  max-width: 60%;\r\n  /* width: 200px; */\r\n  /* height: 50px; */\r\n  margin: 10px 10px 0 10px;\r\n  display: flex;\r\n  align-items: flex-end;\r\n}\r\n.textTime {\r\n  margin-left: 70px;\r\n  color: #777;\r\n  font-weight: 500;\r\n}\r\n.messageItem .avatar {\r\n  min-width: 50px;\r\n  height: 50px;\r\n}\r\n.messageItem .textContainer {\r\n  word-break: break-all;\r\n  margin-left: 10px;\r\n  height: 100%;\r\n}\r\n.messageItem .textContainer .text {\r\n  padding: 10px 15px;\r\n  border-radius: 20px 20px 20px 0;\r\n  background: #e6ecf0;\r\n  font-size: 16px;\r\n}\r\n.actionItem {\r\n  margin: 10px;\r\n  display: flex;\r\n  flex-direction: row;\r\n  justify-content: center;\r\n}\r\n.actionItem p {\r\n  margin: 0;\r\n  width: auto;\r\n  background-color: hsl(0deg 0% 90%);\r\n  color: hsl(207deg 14% 46%);\r\n  padding: 5px 10px;\r\n  border-radius: 10px;\r\n  font-weight: 500;\r\n}\r\n/*////////// currentUser's message ///////////*/\r\n.currentUser {\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: flex-end;\r\n}\r\n.currentUser .textContainer .text {\r\n  border-radius: 20px 20px 0 20px;\r\n  background-color: hsl(24deg 100% 50%);\r\n  color: #fff;\r\n}\r\n.currentUser .textTime {\r\n  /* border: 1px solid #000; */\r\n  margin: 0;\r\n  margin: 10px 10px 0;\r\n}\r\n\r\n.currentUser .mainContent .avatar {\r\n  display: none;\r\n}\r\n\r\n.currentUser .textTime {\r\n}\r\n\r\n/*/ ////////////////// panel ///////////////*/\r\n.meesagePanel {\r\n  height: 60px;\r\n  padding: 10px;\r\n  display: flex;\r\n  border: 1px solid #e6ecf0;\r\n}\r\n#textInput {\r\n  flex: 1;\r\n  height: 40px;\r\n  outline: none;\r\n  border: none;\r\n  padding: 10px;\r\n  background: #e6ecf0;\r\n  border-radius: 10px;\r\n  font-size: 18px;\r\n  font-weight: 500;\r\n}\r\n.sendBtn {\r\n  width: 40px;\r\n  height: 40px;\r\n  padding: 0;\r\n  padding-right: 10px;\r\n  margin-left: 10px;\r\n}\r\n\r\n.sendBtn img {\r\n  transform: rotate(45deg);\r\n}\r\n</style>\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MessageBox.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MessageBox.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./MessageBox.vue?vue&type=template&id=435f38ae&scoped=true&\"\nimport script from \"./MessageBox.vue?vue&type=script&lang=js&\"\nexport * from \"./MessageBox.vue?vue&type=script&lang=js&\"\nimport style0 from \"./MessageBox.vue?vue&type=style&index=0&id=435f38ae&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"435f38ae\",\n  null\n  \n)\n\nexport default component.exports","module.exports = __webpack_public_path__ + \"img/send.376b4246.svg\";","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PublicMessage.vue?vue&type=style&index=0&id=5b13d8e7&scoped=true&lang=css&\"","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MessageBox.vue?vue&type=style&index=0&id=435f38ae&scoped=true&lang=css&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"publicMessage\"},[_c('UserSidebar'),_c('div',{staticClass:\"mainSection\"},[_c('div',{staticClass:\"usersOnline\"},[_c('div',{staticClass:\"title\"},[_c('h1',[_vm._v(\"上線使用者 (\"+_vm._s(_vm.onlineUsersCount)+\")\")])]),_c('div',{staticClass:\"container\"},[_c('ul',{staticClass:\"userList\"},[(_vm.isProcessing)?_c('Spinner'):_vm._e(),_vm._l((_vm.onlineUsers),function(user){return _c('li',{key:user.id,staticClass:\"userItem\"},[_c('div',{staticClass:\"userContainer\"},[_c('div',{staticClass:\"avatar\"},[_c('img',{attrs:{\"src\":_vm._f(\"emptyImageFilter\")(user.avatar),\"alt\":\"\"}})]),_c('div',{staticClass:\"userName\"},[_c('p',[_vm._v(_vm._s(user.name))])]),_c('div',{staticClass:\"userAccount\"},[_c('p',[_vm._v(\"@\"+_vm._s(user.account))])])])])})],2)])]),_c('MessageBox',{ref:\"messageBox\",attrs:{\"currentChat\":_vm.currentChat,\"atPublic\":_vm.atPublic,\"messageList\":_vm.messageList}})],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"publicMessage\">\r\n    <!-- UserSidebar -->\r\n    <UserSidebar></UserSidebar>\r\n\r\n    <!-- mainSection -->\r\n    <div class=\"mainSection\">\r\n      <!-- onlineUserList -->\r\n      <div class=\"usersOnline\">\r\n        <div class=\"title\">\r\n          <h1>上線使用者 ({{ onlineUsersCount }})</h1>\r\n        </div>\r\n        <div class=\"container\">\r\n          <ul class=\"userList\">\r\n            <Spinner v-if=\"isProcessing\"></Spinner>\r\n            <!-- userItem -->\r\n            <!-- other users -->\r\n            <li class=\"userItem\" v-for=\"user in onlineUsers\" :key=\"user.id\">\r\n              <div class=\"userContainer\">\r\n                <div class=\"avatar\">\r\n                  <img :src=\"user.avatar | emptyImageFilter\" alt=\"\" />\r\n                </div>\r\n                <div class=\"userName\">\r\n                  <p>{{ user.name }}</p>\r\n                </div>\r\n                <div class=\"userAccount\">\r\n                  <p>@{{ user.account }}</p>\r\n                </div>\r\n              </div>\r\n            </li>\r\n          </ul>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- messageBox -->\r\n      <MessageBox\r\n        ref=\"messageBox\"\r\n        :currentChat=\"currentChat\"\r\n        :atPublic=\"atPublic\"\r\n        :messageList=\"messageList\"\r\n      ></MessageBox>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport UserSidebar from \"../components/UserSidebar\";\r\nimport MessageBox from \"../components/MessageBox\";\r\nimport Spinner from \"../components/Spinner\";\r\nimport { fromNowFilter } from \"../utils/mixins\";\r\nimport { emptyImageFilter } from \"../utils/mixins\";\r\nimport { Toast } from \"../utils/helpers\";\r\nimport { mapState } from \"vuex\";\r\nimport sucketsAPI from \"../apis/socket\";\r\nexport default {\r\n  name: \"publicMessage\",\r\n  components: { UserSidebar, MessageBox, Spinner },\r\n  mixins: [emptyImageFilter, fromNowFilter],\r\n  data() {\r\n    return {\r\n      currentChat: {\r\n        userId: \"publicRoom\",\r\n        name: \"公開聊天室\",\r\n        account: \"\",\r\n      },\r\n      message: \"\",\r\n      messageList: [],\r\n      onlineUsersCount: 1,\r\n      onlineUsers: [],\r\n      atPublic: true,\r\n      isProcessing: true,\r\n    };\r\n  },\r\n  async mounted() {\r\n    this.$socket.emit(\"leave\");\r\n    this.$store.commit(\"setCurrentRoomId\", 4);\r\n    try {\r\n      this.isProcessing = true;\r\n      this.$refs.messageBox.toggleIsProcessing();\r\n      const { data } = await sucketsAPI.getPublicRoom();\r\n      const { messages, onlineUsersCount, onlineUsers } = data;\r\n      this.messageList = messages;\r\n      this.onlineUsers = onlineUsers;\r\n      this.onlineUsersCount = onlineUsersCount;\r\n\r\n      this.$refs.messageBox.toggleIsProcessing();\r\n      // join room\r\n      this.joinPublicRoom();\r\n    } catch (error) {\r\n      this.isProcessing = false;\r\n      console.log(error);\r\n      Toast.fire({\r\n        icon: \"error\",\r\n        // title: \"無法取得聊天室資料，請稍後再試！\",\r\n        title: error,\r\n      });\r\n    }\r\n  },\r\n  sockets: {\r\n    \"chat message\": function (data) {\r\n      console.log(\"Got message: \" + data.text);\r\n      this.messageList.push({\r\n        id: this.messageList + 1,\r\n        UserId: data.userId,\r\n        type: 1, // messageItem\r\n        avatar: data.avatar,\r\n        message: data.text,\r\n        createdAt: new Date(),\r\n      });\r\n    },\r\n    \"users count\": function (data) {\r\n      const { users: onlineUsers, userCount: onlineUsersCount } = data;\r\n      this.onlineUsers = onlineUsers;\r\n      this.onlineUsersCount = onlineUsersCount;\r\n    },\r\n    message: function (data) {\r\n      this.messageList.push({\r\n        id: this.messageList.length + 1,\r\n        type: 0, // actionItem\r\n        text: data.text,\r\n      });\r\n      this.message = \"\";\r\n    },\r\n  },\r\n  methods: {\r\n    joinPublicRoom() {\r\n      this.$socket.emit(\"join\", {\r\n        username: this.currentUser.name,\r\n        roomId: 4,\r\n        userId: this.currentUser.id,\r\n      });\r\n      this.isProcessing = false;\r\n    },\r\n  },\r\n  computed: {\r\n    ...mapState([\"currentUser\", \"currentRoomId\"]),\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.publicMessage {\r\n  display: flex;\r\n}\r\n.mainSection {\r\n  flex: 1;\r\n  width: 100%;\r\n  height: 100vh;\r\n  border-right: 1px solid #e6ecf0;\r\n  display: flex;\r\n}\r\n.usersOnline {\r\n  border-right: 1px solid #e6ecf0;\r\n  flex: 1;\r\n}\r\n.usersOnline .title {\r\n  border-bottom: 1px solid #e6ecf0;\r\n  height: 55px;\r\n  padding: 10px 15px;\r\n  display: flex;\r\n  align-items: center;\r\n  position: sticky;\r\n  top: 0;\r\n  background-color: #fff;\r\n  z-index: 1;\r\n}\r\n.title h1 {\r\n  font-weight: 700;\r\n  font-size: 19px;\r\n  margin: 0;\r\n}\r\n\r\n.usersOnline .container {\r\n  padding: 0;\r\n}\r\n\r\n.userItem .userContainer {\r\n  height: 60px;\r\n  border-bottom: 1px solid #e6ecf0;\r\n  display: flex;\r\n  align-items: center;\r\n  padding: 10px;\r\n}\r\n.avatar {\r\n  width: 50px;\r\n  height: 50px;\r\n  border: 1px solid #fff;\r\n  border-radius: 50%;\r\n}\r\n.avatar img {\r\n  width: 100%;\r\n  height: 100%;\r\n  border-radius: 50%;\r\n}\r\n.userName {\r\n  height: 100%;\r\n  display: flex;\r\n  align-items: center;\r\n  margin: 0 0px 0 10px;\r\n}\r\n.userName p {\r\n  margin: 0;\r\n  font-size: 14px;\r\n  font-weight: 700;\r\n}\r\n.userAccount {\r\n  height: 100%;\r\n  display: flex;\r\n  align-items: center;\r\n  margin: 0 10px;\r\n}\r\n.userAccount p {\r\n  margin: 0;\r\n  font-size: 14px;\r\n  font-weight: 500;\r\n  color: #657786;\r\n}\r\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PublicMessage.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PublicMessage.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./PublicMessage.vue?vue&type=template&id=5b13d8e7&scoped=true&\"\nimport script from \"./PublicMessage.vue?vue&type=script&lang=js&\"\nexport * from \"./PublicMessage.vue?vue&type=script&lang=js&\"\nimport style0 from \"./PublicMessage.vue?vue&type=style&index=0&id=5b13d8e7&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"5b13d8e7\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}